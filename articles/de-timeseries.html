<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Time Series Disposition Effect • dispositionEffect</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Time Series Disposition Effect">
<meta property="og:description" content="dispositionEffect">
<meta property="og:image" content="https://marcozanotti.github.io/dispositionEffect/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dispositionEffect</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9024</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/de-analysis.html">The Analysis of Disposition Effect</a>
    </li>
    <li>
      <a href="../articles/de-parallel.html">Disposition Effect in Parallel</a>
    </li>
    <li>
      <a href="../articles/de-timeseries.html">Time Series Disposition Effect</a>
    </li>
    <li>
      <a href="../articles/getting-started.html">Getting Started</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/marcozanotti/dispositionEffect/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="de-timeseries_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Time Series Disposition Effect</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/marcozanotti/dispositionEffect/blob/master/vignettes/de-timeseries.Rmd"><code>vignettes/de-timeseries.Rmd</code></a></small>
      <div class="hidden name"><code>de-timeseries.Rmd</code></div>

    </div>

    
    
<p> </p>
<div id="the-importance-of-time" class="section level1">
<h1 class="hasAnchor">
<a href="#the-importance-of-time" class="anchor"></a>The importance of time</h1>
<p>The disposition effect consists in the realization that investors are more likely to sell an asset when it is gaining value compared to when it is losing value. A phenomenon which is closely related to sunk costs’ bias, diminishing sensitivity, and loss aversion.</p>
<p>This irrational phenomenon has strong implications on financial markets. In particular, it is a violation of the well-known “efficient market hypothesis” that bases its foundations on the theory of rational agents.</p>
<p>Hence, timely capturing and understanding irrational behaviours on the financial markets is of primary interest both of researchers and investors. For this reason, the <code>dispositionEffect</code> package allows to quickly collect both aggregate and time series results of the disposition effect, allowing to deeply study the evolution in time of irrationalities.</p>
<p> </p>
</div>
<div id="package-loading" class="section level1">
<h1 class="hasAnchor">
<a href="#package-loading" class="anchor"></a>Package loading</h1>
<p>To load the package simply use the usual <code>library</code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://marcozanotti.github.io/dispositionEffect">dispositionEffect</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org">purrr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></code></pre></div>
<p> </p>
</div>
<div id="data" class="section level1">
<h1 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h1>
<p>The disposition effect analysis is performed on two fundamental types of data frames:</p>
<ul>
<li><p>portfolio transactions, that is all the financial transactions an investor did during a specific period of time. A single transaction is made up of 6 features: the investor id, the asset id, the type of the transaction (it can be a buy or a sell), the traded quantity, the traded price, and the datetime.</p></li>
<li><p>market prices, that is the prices found on the stock markets for each traded asset and each transaction datetimes.</p></li>
</ul>
<p> </p>
</div>
<div id="time-series-computations" class="section level1">
<h1 class="hasAnchor">
<a href="#time-series-computations" class="anchor"></a>Time series computations</h1>
<p>The <code>portfolio_compute</code> function is the core interface of the package and it is used to perform all the gains and losses computations.<br>
In particular, the argument <code>time_series_DE</code> is used to enable time series disposition effect computations.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">portfolio_results_ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/portfolio_compute.html">portfolio_compute</a></span><span class="op">(</span>
    portfolio_transactions <span class="op">=</span> <span class="va">investor</span>, 
    market_prices <span class="op">=</span> <span class="va">marketprices</span>,
    time_series_DE <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<p>Setting it to <code>TRUE</code> makes the function return two different results:</p>
<ul>
<li>the usual aggregate portfolio with gains and losses results</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">portfolio</span> <span class="op">&lt;-</span> <span class="va">portfolio_results_ts</span><span class="op">$</span><span class="va">portfolio</span>
<span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">portfolio</span>, <span class="op">-</span><span class="va">datetime</span><span class="op">)</span>
<span class="co">#&gt;   investor asset quantity price RG_count RL_count PG_count PL_count</span>
<span class="co">#&gt; 1    4273N   ACO      222 2.840        1        0        6        0</span>
<span class="co">#&gt; 2    4273N   AST        0 0.000        0        1        0        0</span>
<span class="co">#&gt; 3    4273N  IT3S        0 0.000        0        1        0        0</span>
<span class="co">#&gt; 4    4273N  LSUG        0 0.000        2        0        4        0</span>
<span class="co">#&gt; 5    4273N   TFI     1400 0.284        0        0        0        0</span></code></pre></div>
<ul>
<li>the new time series disposition effect based on the chosen <code>method</code>
</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">timeseries</span> <span class="op">&lt;-</span> <span class="va">portfolio_results_ts</span><span class="op">$</span><span class="va">timeseries</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">timeseries</span><span class="op">)</span>
<span class="co">#&gt;   investor            datetime DETs_count DEts_count</span>
<span class="co">#&gt; 1    4273N 2018-04-09 11:17:00         NA         NA</span>
<span class="co">#&gt; 2    4273N 2018-05-17 15:06:00  0.0000000        0.0</span>
<span class="co">#&gt; 3    4273N 2018-05-22 17:11:00  0.2500000        0.5</span>
<span class="co">#&gt; 4    4273N 2018-05-28 14:30:00  0.2500000        0.0</span>
<span class="co">#&gt; 5    4273N 2018-06-01 15:27:00 -0.1666667       -0.5</span>
<span class="co">#&gt; 6    4273N 2018-06-01 15:43:00 -0.1666667        0.0</span></code></pre></div>
<p>For every transaction datetime two different disposition effect are computed:</p>
<ul>
<li>DEts, disposition effect on gains and losses at time t<br>
</li>
<li>DETs, disposition effect on gains and losses at time t taking into account all the previous results</li>
</ul>
<p>Note that, by the moment, the time series computations of disposition effect are allowed for <code>"count"</code> and <code>"value"</code> methods only (with the latter the disposition difference is implemented instead of disposition effect).</p>
<p> </p>
</div>
<div id="investors-time-series-disposition-effect" class="section level1">
<h1 class="hasAnchor">
<a href="#investors-time-series-disposition-effect" class="anchor"></a>Investor’s time series disposition effect</h1>
<p>The <code>disposition_summary_ts</code> function can be used to summarise the evolution of disposition effect over time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/disposition_effect.html">disposition_summary_ts</a></span><span class="op">(</span><span class="va">timeseries</span><span class="op">)</span>
<span class="co">#&gt;   investor   stat DETs_count  DEts_count</span>
<span class="co">#&gt; 1    4273N    Min -0.3666667 -1.00000000</span>
<span class="co">#&gt; 2    4273N     Q1 -0.3199405  0.00000000</span>
<span class="co">#&gt; 3    4273N Median -0.2916667  0.00000000</span>
<span class="co">#&gt; 4    4273N     Q3 -0.1166667  0.00000000</span>
<span class="co">#&gt; 5    4273N   Mean -0.1949405  0.06666667</span>
<span class="co">#&gt; 6    4273N    Max  0.2500000  1.00000000</span>
<span class="co">#&gt; 7    4273N  StDev  0.1912683  0.49521520</span></code></pre></div>
<p>A visual time series analysis can be performed as usual with <a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">timeseries</span> <span class="op">%&gt;%</span> 
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"DE"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">value</span>, col <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_colour_viridis_d</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
        title <span class="op">=</span> <span class="st">"Time Series Disposition Effect results"</span>,
        subtitle <span class="op">=</span> <span class="st">"Method Count"</span>,
        x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code></pre></div>
<p><img src="de-timeseries_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;"></p>
<p> </p>
</div>
<div id="assets-time-series-disposition-effect" class="section level1">
<h1 class="hasAnchor">
<a href="#assets-time-series-disposition-effect" class="anchor"></a>Assets’ time series disposition effect</h1>
<p>The time series analysis of disposition effect can be greatly improved also by computing the disposition effect over time on specif assets traded by the investor.<br>
Indeed, the argument <code>assets_time_series_DE</code> allows to specify a character vector of assets’ id (that must be traded by the investor) on which to compute the disposition effect over time.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">portfolio_results_ts_assets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/portfolio_compute.html">portfolio_compute</a></span><span class="op">(</span>
    portfolio_transactions <span class="op">=</span> <span class="va">investor</span>, 
    market_prices <span class="op">=</span> <span class="va">marketprices</span>,
    time_series_DE <span class="op">=</span> <span class="cn">TRUE</span>,
    assets_time_series_DE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ACO"</span>, <span class="st">"LSUG"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">timeseries_assets</span> <span class="op">&lt;-</span> <span class="va">portfolio_results_ts_assets</span><span class="op">$</span><span class="va">timeseries</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">timeseries_assets</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>
<span class="co">#&gt;              datetime DETs_count DEts_count ACO_DETs_count ACO_DEts_count</span>
<span class="co">#&gt; 1 2018-04-09 11:17:00         NA         NA             NA             NA</span>
<span class="co">#&gt; 2 2018-05-17 15:06:00  0.0000000        0.0            0.0              0</span>
<span class="co">#&gt; 3 2018-05-22 17:11:00  0.2500000        0.5            0.5              1</span>
<span class="co">#&gt; 4 2018-05-28 14:30:00  0.2500000        0.0            0.5             NA</span>
<span class="co">#&gt; 5 2018-06-01 15:27:00 -0.1666667       -0.5            0.5             NA</span>
<span class="co">#&gt; 6 2018-06-01 15:43:00 -0.1666667        0.0            0.5             NA</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">timeseries_assets</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;              datetime DETs_count DEts_count LSUG_DETs_count LSUG_DEts_count</span>
<span class="co">#&gt; 1 2018-04-09 11:17:00         NA         NA              NA              NA</span>
<span class="co">#&gt; 2 2018-05-17 15:06:00  0.0000000        0.0              NA              NA</span>
<span class="co">#&gt; 3 2018-05-22 17:11:00  0.2500000        0.5               0               0</span>
<span class="co">#&gt; 4 2018-05-28 14:30:00  0.2500000        0.0               0               0</span>
<span class="co">#&gt; 5 2018-06-01 15:27:00 -0.1666667       -0.5               0               0</span>
<span class="co">#&gt; 6 2018-06-01 15:43:00 -0.1666667        0.0               0               0</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/disposition_effect.html">disposition_summary_ts</a></span><span class="op">(</span><span class="va">timeseries_assets</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>
<span class="co">#&gt;     stat DETs_count  DEts_count ACO_DETs_count ACO_DEts_count</span>
<span class="co">#&gt; 1    Min -0.3666667 -1.00000000      0.0000000      0.0000000</span>
<span class="co">#&gt; 2     Q1 -0.3199405  0.00000000      0.2708333      0.0000000</span>
<span class="co">#&gt; 3 Median -0.2916667  0.00000000      0.5000000      0.0000000</span>
<span class="co">#&gt; 4     Q3 -0.1166667  0.00000000      0.5000000      0.0000000</span>
<span class="co">#&gt; 5   Mean -0.1949405  0.06666667      0.3940476      0.1111111</span>
<span class="co">#&gt; 6    Max  0.2500000  1.00000000      0.5000000      1.0000000</span>
<span class="co">#&gt; 7  StDev  0.1912683  0.49521520      0.1657201      0.3333333</span>
<span class="fu"><a href="../reference/disposition_effect.html">disposition_summary_ts</a></span><span class="op">(</span><span class="va">timeseries_assets</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;     stat DETs_count  DEts_count LSUG_DETs_count LSUG_DEts_count</span>
<span class="co">#&gt; 1    Min -0.3666667 -1.00000000       0.0000000       0.0000000</span>
<span class="co">#&gt; 2     Q1 -0.3199405  0.00000000       0.2000000       0.0000000</span>
<span class="co">#&gt; 3 Median -0.2916667  0.00000000       0.3333333       0.0000000</span>
<span class="co">#&gt; 4     Q3 -0.1166667  0.00000000       0.3333333       0.7500000</span>
<span class="co">#&gt; 5   Mean -0.1949405  0.06666667       0.2235294       0.3333333</span>
<span class="co">#&gt; 6    Max  0.2500000  1.00000000       0.3333333       1.0000000</span>
<span class="co">#&gt; 7  StDev  0.1912683  0.49521520       0.1393261       0.5163978</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">timeseries_assets</span> <span class="op">%&gt;%</span> 
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"DE"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">value</span>, col <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_colour_viridis_d</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">name</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
        title <span class="op">=</span> <span class="st">"Assets Time Series Disposition Effect results"</span>,
        subtitle <span class="op">=</span> <span class="st">"Method Count"</span>,
        x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code></pre></div>
<p><img src="de-timeseries_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>This way it is possible to better understand the behaviour of an investor on his traded assets. It may be possible, in practice that, disposition effect behaviours are only present on some specific assets, and understanding what assets are more subject to irrationality can be critical.</p>
<p> </p>
</div>
<div id="compare-investors-behaviours" class="section level1">
<h1 class="hasAnchor">
<a href="#compare-investors-behaviours" class="anchor"></a>Compare investors’ behaviours</h1>
<p>In order to better understand the relevance of the time series analysis of disposition effect, we can test the results on the <code>DEanalysis</code> real sample dataset.</p>
<p>See <a href="https://marcozanotti.github.io/dispositionEffect/articles/de-parallel.html">“Disposition Effect in Parallel”</a> to speed up computations with parallel computing in R.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">trx</span> <span class="op">&lt;-</span> <span class="va">DEanalysis</span><span class="op">$</span><span class="va">transactions</span>
<span class="va">mkt</span> <span class="op">&lt;-</span> <span class="va">DEanalysis</span><span class="op">$</span><span class="va">marketprices</span>
<span class="va">investor_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">trx</span><span class="op">$</span><span class="va">investor</span><span class="op">)</span>

<span class="va">res_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"list"</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">investor_id</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">investor_id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp_trx</span> <span class="op">&lt;-</span> <span class="va">trx</span> <span class="op">%&gt;%</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">investor</span> <span class="op">==</span> <span class="va">investor_id</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
  <span class="va">tmp_res</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span>
    <span class="fu">dispositionEffect</span><span class="fu">::</span><span class="fu"><a href="../reference/portfolio_compute.html">portfolio_compute</a></span><span class="op">(</span>
      portfolio_transactions <span class="op">=</span> <span class="va">tmp_trx</span>,
      market_prices <span class="op">=</span> <span class="va">mkt</span>,
      time_series_DE <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span>,
    error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="st">"Error"</span>
  <span class="op">)</span>
  <span class="va">res_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tmp_res</span> <span class="co"># save results</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">tmp_trx</span>, <span class="va">tmp_res</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># extract time series results for each investor</span>
<span class="va">timeseries_10_investors</span> <span class="op">&lt;-</span> <span class="va">res_list</span> <span class="op">%&gt;%</span> 
  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="st">"timeseries"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">timeseries_10_investors</span>, <span class="va">disposition_summary_ts</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">stat</span> <span class="op">==</span> <span class="st">"Mean"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">DETs_count</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    investor stat   DETs_count   DEts_count</span>
<span class="co">#&gt; 1     46Z68 Mean  0.671328859  0.181704261</span>
<span class="co">#&gt; 2     44382 Mean  0.549636005  0.053198948</span>
<span class="co">#&gt; 3     8ZQ32 Mean  0.512062102  0.067820774</span>
<span class="co">#&gt; 4     62NQ8 Mean  0.447932758  0.029153729</span>
<span class="co">#&gt; 5     743Q1 Mean -0.004332159 -0.004701290</span>
<span class="co">#&gt; 6     QZNZN Mean -0.039002566  0.003532508</span>
<span class="co">#&gt; 7     4Q17Z Mean -0.164163586 -0.024435599</span>
<span class="co">#&gt; 8     QZ621 Mean -0.177971450  0.047406639</span>
<span class="co">#&gt; 9     784ZZ Mean -0.262808387 -0.007247631</span>
<span class="co">#&gt; 10    QZ31Q Mean -0.298977398 -0.043965299</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">timeseries_10_investors</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"DE"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">value</span>, col <span class="op">=</span> <span class="va">investor</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_colour_viridis_d</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">name</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
        title <span class="op">=</span> <span class="st">"10 Investors Time Series Disposition Effect results"</span>,
        subtitle <span class="op">=</span> <span class="st">"Method Count"</span>,
        x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code></pre></div>
<p><img src="de-timeseries_files/figure-html/unnamed-chunk-15-1.png" width="100%" style="display: block; margin: auto;"></p>
<p> </p>
<hr>
<p>For more tutorials on disposition effect visit <a href="https://marcozanotti.github.io/dispositionEffect">dispositionEffect</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lorenzo Mazzucchelli, Marco Zanotti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
